<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 More useful information | Quantitative methods in plant breeding: the digital tutorials.</title>
  <meta name="description" content="This is the online tutorial booklet for the QMPB course run at NIAB. The online book was formed using R bookdown." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 More useful information | Quantitative methods in plant breeding: the digital tutorials." />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the online tutorial booklet for the QMPB course run at NIAB. The online book was formed using R bookdown." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 More useful information | Quantitative methods in plant breeding: the digital tutorials." />
  
  <meta name="twitter:description" content="This is the online tutorial booklet for the QMPB course run at NIAB. The online book was formed using R bookdown." />
  

<meta name="author" content="NIAB 2021" />


<meta name="date" content="2021-01-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="R-and-stats.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="Acknow.html"><a href="Acknow.html"><i class="fa fa-check"></i><b>2</b> Acknowledgements and Contents</a></li>
<li class="chapter" data-level="3" data-path="R-and-stats.html"><a href="R-and-stats.html"><i class="fa fa-check"></i><b>3</b> R and Rstudio: a general introduction with statistics.</a><ul>
<li class="chapter" data-level="3.1" data-path="R-and-stats.html"><a href="R-and-stats.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="R-and-stats.html"><a href="R-and-stats.html#getting-the-data-ready"><i class="fa fa-check"></i><b>3.1.1</b> Getting the data ready</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="R-and-stats.html"><a href="R-and-stats.html#the-rstudio-layout-workspace-and-enviroment."><i class="fa fa-check"></i><b>3.2</b> The Rstudio layout, workspace and enviroment.</a><ul>
<li class="chapter" data-level="3.2.1" data-path="R-and-stats.html"><a href="R-and-stats.html#working-directory"><i class="fa fa-check"></i><b>3.2.1</b> Working directory</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="R-and-stats.html"><a href="R-and-stats.html#basic-r-syntx"><i class="fa fa-check"></i><b>3.3</b> Basic R Syntx</a></li>
<li class="chapter" data-level="3.4" data-path="R-and-stats.html"><a href="R-and-stats.html#reading-in-data"><i class="fa fa-check"></i><b>3.4</b> Reading in data</a></li>
<li class="chapter" data-level="3.5" data-path="R-and-stats.html"><a href="R-and-stats.html#understanding-data-types-and-r-objects"><i class="fa fa-check"></i><b>3.5</b> Understanding data types and R objects</a><ul>
<li class="chapter" data-level="3.5.1" data-path="R-and-stats.html"><a href="R-and-stats.html#summary"><i class="fa fa-check"></i><b>3.5.1</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="R-and-stats.html"><a href="R-and-stats.html#summarising-and-displaying-data"><i class="fa fa-check"></i><b>3.6</b> Summarising and displaying data</a></li>
<li class="chapter" data-level="3.7" data-path="R-and-stats.html"><a href="R-and-stats.html#calculations-and-data-manipulation"><i class="fa fa-check"></i><b>3.7</b> Calculations and data manipulation</a><ul>
<li class="chapter" data-level="3.7.1" data-path="R-and-stats.html"><a href="R-and-stats.html#sorting-data"><i class="fa fa-check"></i><b>3.7.1</b> Sorting data</a></li>
<li class="chapter" data-level="3.7.2" data-path="R-and-stats.html"><a href="R-and-stats.html#relationships-between-variates."><i class="fa fa-check"></i><b>3.7.2</b> Relationships between variates.</a></li>
<li class="chapter" data-level="3.7.3" data-path="R-and-stats.html"><a href="R-and-stats.html#exporting-your-script-and-workspace"><i class="fa fa-check"></i><b>3.7.3</b> Exporting your script and workspace</a></li>
<li class="chapter" data-level="3.7.4" data-path="R-and-stats.html"><a href="R-and-stats.html#saving-a-data-table"><i class="fa fa-check"></i><b>3.7.4</b> Saving a data table</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="R-and-stats.html"><a href="R-and-stats.html#basic-statistical-analysis"><i class="fa fa-check"></i><b>3.8</b> Basic statistical analysis</a><ul>
<li class="chapter" data-level="3.8.1" data-path="R-and-stats.html"><a href="R-and-stats.html#the-t-test"><i class="fa fa-check"></i><b>3.8.1</b> The t-test</a></li>
<li class="chapter" data-level="3.8.2" data-path="R-and-stats.html"><a href="R-and-stats.html#linear-regression"><i class="fa fa-check"></i><b>3.8.2</b> Linear Regression</a></li>
<li class="chapter" data-level="3.8.3" data-path="R-and-stats.html"><a href="R-and-stats.html#multiple-regression"><i class="fa fa-check"></i><b>3.8.3</b> Multiple regression</a></li>
<li class="chapter" data-level="3.8.4" data-path="R-and-stats.html"><a href="R-and-stats.html#the-analysis-of-variance"><i class="fa fa-check"></i><b>3.8.4</b> The analysis of variance</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="R-and-stats.html"><a href="R-and-stats.html#categorical-data---the-chi-squared-test"><i class="fa fa-check"></i><b>3.9</b> Categorical data - <em>the chi-squared test</em></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="more-useful-information.html"><a href="more-useful-information.html"><i class="fa fa-check"></i><b>4</b> More useful information</a><ul>
<li class="chapter" data-level="4.0.1" data-path="more-useful-information.html"><a href="more-useful-information.html#plotting-graphs"><i class="fa fa-check"></i><b>4.0.1</b> Plotting Graphs</a></li>
<li class="chapter" data-level="4.1" data-path="more-useful-information.html"><a href="more-useful-information.html#probability-distributions"><i class="fa fa-check"></i><b>4.1</b> Probability distributions</a></li>
<li class="chapter" data-level="4.2" data-path="more-useful-information.html"><a href="more-useful-information.html#random-number-generation"><i class="fa fa-check"></i><b>4.2</b> Random number generation</a></li>
<li class="chapter" data-level="4.3" data-path="more-useful-information.html"><a href="more-useful-information.html#loops-second-example"><i class="fa fa-check"></i><b>4.3</b> Loops: <em>second example</em></a></li>
<li class="chapter" data-level="4.4" data-path="more-useful-information.html"><a href="more-useful-information.html#miscellany"><i class="fa fa-check"></i><b>4.4</b> Miscellany</a><ul>
<li class="chapter" data-level="4.4.1" data-path="more-useful-information.html"><a href="more-useful-information.html#learn-more"><i class="fa fa-check"></i><b>4.4.1</b> Learn more</a></li>
<li class="chapter" data-level="4.4.2" data-path="more-useful-information.html"><a href="more-useful-information.html#packages"><i class="fa fa-check"></i><b>4.4.2</b> Packages</a></li>
<li class="chapter" data-level="4.4.3" data-path="more-useful-information.html"><a href="more-useful-information.html#r-commander-httpwww.rcommander.com"><i class="fa fa-check"></i><b>4.4.3</b> R commander <span>http://www.rcommander.com/</span></a></li>
<li class="chapter" data-level="4.4.4" data-path="more-useful-information.html"><a href="more-useful-information.html#the-tidyverse"><i class="fa fa-check"></i><b>4.4.4</b> The Tidyverse</a></li>
<li class="chapter" data-level="4.4.5" data-path="more-useful-information.html"><a href="more-useful-information.html#other-resources"><i class="fa fa-check"></i><b>4.4.5</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="more-useful-information.html"><a href="more-useful-information.html#list-of-commands-mainly-described-in-this-guide."><i class="fa fa-check"></i><b>4.5</b> List of commands, mainly described in this guide.</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quantitative methods in plant breeding: the digital tutorials.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="more-useful-information" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> More useful information</h1>
<div id="plotting-graphs" class="section level3">
<h3><span class="header-section-number">4.0.1</span> Plotting Graphs</h3>
<p>Graphical methods were introduced in context in the sections on summary statistics and on basic statistical analysis. The following methods have been used:</p>
<p><code>hist()</code> produces a histogram</p>
<p><code>plot()</code> produces a scatter graph</p>
<p><code>abline()</code> adds a line of best fit to a scatter graph</p>
<p><code>boxplot()</code> produces a box-and-whisker plot.</p>
<p><code>pairs()</code> produces a matrix of scatter plots.</p>
<p>Control of many graphics parameters - font sizes, colours and so on - is given by the command <code>par()</code>. Type <code>help(par)</code> for more details. One useful option is:</p>
<p><code>par(mfrow=c(x,y))</code></p>
<p>This will plot graphs successively in a window x graphs wide by y graphs deep. Once the panel of graphs is complete, the next graph will overwrite the whole window and start filling the panel again. For example, the following commands set up a panel two graphs deep by three wide and fills in the first four slots.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="more-useful-information.html#cb180-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb180-2"><a href="more-useful-information.html#cb180-2"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="kw">plot</span>(<span class="kw">runif</span>(<span class="dv">100</span>),<span class="kw">runif</span>(<span class="dv">100</span>))</span>
<span id="cb180-3"><a href="more-useful-information.html#cb180-3"></a><span class="kw">hist</span>(<span class="kw">rnorm</span>(<span class="dv">1000</span>))</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-108-1.png" width="672" /></p>
<p>As you can see, the graphs need not all be of the same type. The related version of the command <code>par(mfcol=c(x,y))</code> will produce a graphical window of the same dimensions but fill it in column order rather than in row order.</p>
<p>A benefit of RStudio over native R is that graphs are saved and you can scroll back and forwards over previous efforts and export them, either as files or to the clipboard. In native R, the export of graphs is no more complicated, but they are overwritten so you cannot scroll to inspect previous plots but must recreate them.</p>
<p>Although R generates graphs very quickly and simply, the labeling and formatting are often not ideal. To alter graph titles, include the options:</p>
<p><code>main="Main title"</code></p>
<p><code>sub="subtitle"</code></p>
<p><code>xlab="x-label"</code></p>
<p><code>ylab="y-label"</code></p>
<p>For example:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="more-useful-information.html#cb181-1"></a><span class="co">#switch back to plotting a single plot</span></span>
<span id="cb181-2"><a href="more-useful-information.html#cb181-2"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb181-3"><a href="more-useful-information.html#cb181-3"></a><span class="co">#make plot</span></span>
<span id="cb181-4"><a href="more-useful-information.html#cb181-4"></a><span class="kw">plot</span>(year,yield,<span class="dt">main=</span><span class="st">&quot;TG panel yields over time&quot;</span>,<span class="dt">sub=</span><span class="st">&quot;example scatterplot&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;yield in quintal / ha&quot;</span>,<span class="dt">xlab=</span><span class="st">&quot;year first in trial&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-109-1.png" width="672" /></p>
<p>We have only used the basic plotting commands which come with the core R package. Very highly rated, and increasingly used is a package called “ggplot2” <a href="http://ggplot2.org/" class="uri">http://ggplot2.org/</a>. This is generally included as part of the tidyverse too.There is no time go into this in detail. Select ggplot2 from the “Packages” tab in the bottom right window to active the package. If not installed, click on the “Packages” tab in the bottom right window, then click “install” and enter ggplot2 as the package you wish to install. Alternatively, you can run this line: <code>install.packages("ggplot2")</code>, then load the package from your library:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="more-useful-information.html#cb182-1"></a><span class="kw">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.0.2</code></pre>
<p>Then:</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="more-useful-information.html#cb184-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>TG_data_for_day_<span class="dv">1</span>,<span class="kw">aes</span>(<span class="dt">x=</span>year,<span class="dt">y=</span>yield)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">shape=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-111-1.png" width="672" /></p>
<p>aes stands for aesthetics. If you think this look better and is easier, then ggplot2 is for you. See the web site for more details.</p>
<p>There’s plenty more you can do with ggplot2. There are some good <a href="https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf">cheat sheets</a> available too.</p>
</div>
<div id="probability-distributions" class="section level2">
<h2><span class="header-section-number">4.1</span> Probability distributions</h2>
<p>In this section we describe how to use R to look up the p-value associated with the most
commonly used test statistics and how to look up test statistics associated with p-values.</p>
<p>Firstly the p-value associated with chi-squared:</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="more-useful-information.html#cb185-1"></a><span class="kw">pchisq</span>(<span class="fl">3.84</span>,<span class="dv">1</span>,<span class="dt">lower.tail=</span>F)</span></code></pre></div>
<pre><code>## [1] 0.05004352</code></pre>
<p>The parameters given to pchisq, in order, are:
3.84 value of the test statistic.
1 the degrees of freedom
lower.tail If set to T (the default) the result is the cumulative distribution up to the value of the test statistic - 0.95 in the example. For significance testing we require the area of the upper tail: 1-0.95 and so set lower.tail=F.</p>
<p>To calculate a chi squared from a p-value we use the command qchisq:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="more-useful-information.html#cb187-1"></a><span class="kw">qchisq</span>(<span class="fl">0.05</span>,<span class="dv">1</span>,<span class="dt">lower.tail=</span>F)</span></code></pre></div>
<pre><code>## [1] 3.841459</code></pre>
<p>The syntax is identical to that for <code>pchisq()</code>, so we are required to include <code>lower.tail=F</code>.
Examples for the F distribution are shown below.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="more-useful-information.html#cb189-1"></a><span class="kw">pf</span>(<span class="fl">3.84</span>,<span class="dv">1</span>,<span class="dv">1000</span>,<span class="dt">lower.tail=</span>F)</span></code></pre></div>
<pre><code>## [1] 0.05032099</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="more-useful-information.html#cb191-1"></a><span class="kw">qf</span>(<span class="fl">0.05</span>,<span class="dv">1</span>,<span class="dv">1000</span>,<span class="dt">lower.tail=</span>F)</span></code></pre></div>
<pre><code>## [1] 3.850775</code></pre>
<p>The examples here are for 1 degree of freedom for the numerator and 1000 degrees of freedom for the denominator. The results are identical to those for a chi-squared test with 1 df. In fact, a chi-squared test with n degrees of freedom is identical to an F test with n degrees of freedom in the numerator and a very large number of degrees of freedom (ideally infinite) in the denominator.</p>
<p>Values for probabilities associated with a normal distribution are:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="more-useful-information.html#cb193-1"></a><span class="kw">pnorm</span>(<span class="fl">1.96</span>,<span class="dt">lower.tail=</span>F)</span></code></pre></div>
<pre><code>## [1] 0.0249979</code></pre>
<p>This probability is for a standardised normal distribution: with a mean of zero and a variance of 1. The probability is for a single tail of the distribution. Generally, we would require the result for a two tailed test - the probability of values higher than 1.96 and lower than -1.96. This probability is just double that for a single tail: 0.05 in this case. Again, this is the same value as for chi-squared with 1 degree of freedom. If a variate has a standardised normal distribution, the variate squared has a chi-squared distribution with 1 degree of freedom:
1.962 = -1.962 = 3..84.</p>
<p>Probabilities associated with normally distributed variables with different means and variances are produced by specifying the mean and variance.</p>
<p><code>pnorm(q,mean=x,sd=y)</code> with the inverse function: <code>qnorm(p,mean=x,sd=y)</code></p>
<p><code>lower.tail=F</code> can be added if required. The values for mean and standard deviation are now user specified (substitute for x and y in pnorm and qnorm). The default values are 0 and 1.</p>
<p>Finally, the t-test:</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="more-useful-information.html#cb195-1"></a><span class="kw">pt</span>(<span class="fl">1.96</span>,<span class="dv">1000</span>,<span class="dt">lower.tail=</span>F) </span></code></pre></div>
<pre><code>## [1] 0.02513659</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="more-useful-information.html#cb197-1"></a><span class="kw">pt</span>(<span class="op">-</span><span class="fl">1.96</span>,<span class="dv">1000</span>) </span></code></pre></div>
<pre><code>## [1] 0.02513659</code></pre>
<p>We usually carry out a two sided t test - so we require the sum of the lower and upper tail probabilities: equal to two times the single tailed probability. The inverse function follows the usual format and nomenclature:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="more-useful-information.html#cb199-1"></a><span class="kw">qt</span>(<span class="fl">0.025</span>,<span class="dv">10000</span>,<span class="dt">lower.tail=</span>F)</span></code></pre></div>
<pre><code>## [1] 1.960201</code></pre>
</div>
<div id="random-number-generation" class="section level2">
<h2><span class="header-section-number">4.2</span> Random number generation</h2>
<p>R has excellent random number generators for several distributions:</p>
<p><code>rnorm(n, mean=0, sd=1)</code></p>
<p><code>runif(n, min=0, max=1)</code></p>
<p><code>rchisq(n, df, ncp=0)</code></p>
<p><code>rt(n, df, ncp)</code></p>
<p><code>rf(n, df1, df2, ncp)</code>
and there are others. These are self explanatory except for ‘ncp’. This is the non-centrality parameter. For most use, this will be zero. It is used in power calculations to provide the distribution of the test statistic under an alternative hypothesis. The ‘ncp’ is the value you would get if you plug values of parameters or observations you expect under the alternative hypothesis into the formula for the test. For example, with a t test, the value under the null hypothesis is zero. If you expect the true difference between your means to be three, then this is the ‘ncp’. For a chi-squared test, you would create expected numbers from expected proportions from an alternative hypothesis and calculate a chi-squared value which will be the ‘ncp’ for power calculations.</p>
</div>
<div id="loops-second-example" class="section level2">
<h2><span class="header-section-number">4.3</span> Loops: <em>second example</em></h2>
<p>A block of commands, each on a separate line, can be saved in a file and later pasted into R where it will execute (i.e. run as a program). There is, of course, much more to programming in R than this, but this is enough to get you started. The most common requirement is to repeat an operation multiple times. Below is the format for a simple loop which can be easily edited to fit your own purposes.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="more-useful-information.html#cb201-1"></a>no_times&lt;-<span class="dv">100000</span></span>
<span id="cb201-2"><a href="more-useful-information.html#cb201-2"></a>diff&lt;-<span class="ot">NA</span></span>
<span id="cb201-3"><a href="more-useful-information.html#cb201-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>no_times) {</span>
<span id="cb201-4"><a href="more-useful-information.html#cb201-4"></a>diff[i]&lt;-<span class="kw">runif</span>(<span class="dv">1</span>)<span class="op">-</span><span class="kw">runif</span>(<span class="dv">1</span>)</span>
<span id="cb201-5"><a href="more-useful-information.html#cb201-5"></a>}</span></code></pre></div>
<p>This code plots the distribution of the difference in value between a pair of uniformly distributed values. It takes a while to run: you may prefer to reduce the number from 100,000. If you cut and paste the code into R you should get something like this:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="more-useful-information.html#cb202-1"></a><span class="kw">hist</span>(diff,<span class="dt">breaks=</span><span class="dv">1000</span>)</span></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-121-1.png" width="672" /></p>
<p>Note that the beginning and end of the loop (or any R program block) is defined by curly brackets. The indentation isn’t obligatory but is good programming practice. The program creates a vector, “diff” which is then indexed by “i”. If diff wasn’t first created outside the loop, the program would fail.</p>
<p>Loops in R can run slowly. Often, they can be avoided by the use of the command <code>apply()</code>:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="more-useful-information.html#cb203-1"></a><span class="kw">apply</span>(TG_data_for_day_<span class="dv">1</span>,<span class="dv">2</span>,sd)</span></code></pre></div>
<pre><code>## Warning in var(if (is.vector(x) || is.factor(x)) x else as.double(x), na.rm =
## na.rm): NAs introduced by coercion

## Warning in var(if (is.vector(x) || is.factor(x)) x else as.double(x), na.rm =
## na.rm): NAs introduced by coercion</code></pre>
<pre><code>##     variety        year      ORIGIN        Rht2       PpdD1       yield 
##          NA  11.5105231          NA          NA   0.4188383   6.2670999 
## CALLOW_2011 FRANCE_2010 FRANCE_2011    LGE_2010    LGE_2011   NIAB_2011 
##   7.5343555   7.6016464   8.0943785   6.7535158   7.2916383   5.1220707 
##          FT          HT        AWNS 
##   3.2931899   7.5069727          NA</code></pre>
<p>The first argument to apply is the dataset or matrix we want to work on, the second is whether we want to loop over rows (1), or columns (2 - as in this example). The third is the function you wish to loop over. So here we loop over columns to calculate the standard deviation of each.</p>
<p>The missing data for Rht2 has caused the standard deviation to be returned as NA. We need to include na.rrn=T as an option. Unfortunately, there is no way I know to do this within apply. Instead we need to define our own function (which also allows us to look at how to define functions in R in general - another useful lesson in learning to program in R).</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="more-useful-information.html#cb206-1"></a>sd.na.rm.is.t&lt;-<span class="cf">function</span>(x) <span class="kw">sd</span>(x,<span class="dt">na.rm=</span>T)</span></code></pre></div>
<p><code>function(x)</code> defines a set of arguments that our new function <code>sd.na.rm.is.t</code> requires. Here we only need one argument; the name of the dataset, which will be equated to x when we run the function. Following that, on the same line, is the set of commands we want to run. Here we are running an inbuilt function, <code>sd(x,na.rm=T)</code>,which will take the data vector x as the source of data.</p>
<p>Try:
<code>sd(AWNS)</code>
<code>sd(AWNS,na.rm=T)</code>
<code>sd.na.rm.is.t(AWNS)</code></p>
<p>So now:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="more-useful-information.html#cb207-1"></a><span class="kw">apply</span>(TG_data_for_day_<span class="dv">1</span>,<span class="dv">2</span>,sd.na.rm.is.t)</span></code></pre></div>
<pre><code>## Warning in var(if (is.vector(x) || is.factor(x)) x else as.double(x), na.rm =
## na.rm): NAs introduced by coercion

## Warning in var(if (is.vector(x) || is.factor(x)) x else as.double(x), na.rm =
## na.rm): NAs introduced by coercion</code></pre>
<pre><code>##     variety        year      ORIGIN        Rht2       PpdD1       yield 
##          NA  11.5105231          NA   0.4981119   0.4188383   6.2670999 
## CALLOW_2011 FRANCE_2010 FRANCE_2011    LGE_2010    LGE_2011   NIAB_2011 
##   7.5343555   7.6016464   8.0943785   6.7535158   7.2916383   5.1220707 
##          FT          HT        AWNS 
##   3.2931899   7.5069727   0.2716556</code></pre>
<p>This returns the desired standard deviation of each column of data. We still get NA’s and warnings for attempting to calculate the standard deviation for non-numeric data (for Variety name and country of origin). We could specify which columns of TG.data.for.day.1 to work on to avoid this.</p>
<p><code>apply(TG_data_for_day_1[,-1:-3],2,sd.na.rm.is.t)</code></p>
<p>The <code>[,-1:-3]</code> informs R that we need all rows but to drop the first three columns.
This is long winded, but functions are frequently longer sequences of commands rather than just one as in our example. The commands for a long function, which will run over many lines are bracketed with { and }, just as in loops using ‘for’.</p>
</div>
<div id="miscellany" class="section level2">
<h2><span class="header-section-number">4.4</span> Miscellany</h2>
<p>Included here are some useful commands which have not so far been described and some less frequently used commands which come in handy from time to time.</p>
<p><code>attributes(object)</code></p>
<p>Gives information on the object which is often to help you work out what you’ve done.</p>
<p><code>cbind(datasetA)</code> and <code>rbind(datasetB)</code></p>
<p>Joins up two datasets by rows or columns. For example:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="more-useful-information.html#cb210-1"></a>temp&lt;-TG_data_for_day_<span class="dv">1</span>[,<span class="dv">1</span>] [<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb210-2"><a href="more-useful-information.html#cb210-2"></a><span class="kw">cbind</span>(temp,TG_data_for_day_<span class="dv">1</span>[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]  )</span></code></pre></div>
<pre><code>##       temp  variety year ORIGIN
## 1   AARDEN   AARDEN 2003    DEU
## 2 AARDVARK AARDVARK 1997    GBR
## 3    ABELE    ABELE 1970    GBR
## 4      ABO      ABO 1977    FRA
## 5   ACCESS   ACCESS 1998    GBR</code></pre>
<p>We have created a subset of the data with two copies of the variety names. I’ve limited this to the first 5 rows to save paper. There is no particular reason we would want to do this, it’s just as a demonstration.</p>
<p>Next, we create two copies of the first three columns of the data using rbind:</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="more-useful-information.html#cb212-1"></a>temp&lt;-TG_data_for_day_<span class="dv">1</span>[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb212-2"><a href="more-useful-information.html#cb212-2"></a>temp2&lt;-<span class="kw">rbind</span>(temp,TG_data_for_day_<span class="dv">1</span>[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>])</span>
<span id="cb212-3"><a href="more-useful-information.html#cb212-3"></a><span class="kw">head</span>(temp2[<span class="kw">order</span>(temp2<span class="op">$</span>variety),])</span></code></pre></div>
<pre><code>##      variety year ORIGIN
## 1     AARDEN 2003    DEU
## 377   AARDEN 2003    DEU
## 2   AARDVARK 1997    GBR
## 378 AARDVARK 1997    GBR
## 3      ABELE 1970    GBR
## 379    ABELE 1970    GBR</code></pre>
<p>Note, that in ordering the data we have used <code>order(temp2$variety)</code> rather than <code>order(variety)</code> because we require the version of “variety”" associated with the new structure temp2, not the version of variety that we attached earlier.</p>
<p><code>dim(x)</code></p>
<p>Retrieve the dimensions of an array or dataset.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="more-useful-information.html#cb214-1"></a><span class="kw">dim</span>(TG_data_for_day_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 376  15</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="more-useful-information.html#cb216-1"></a><span class="kw">dim</span>(temp2)</span></code></pre></div>
<pre><code>## [1] 752   3</code></pre>
<p><code>help(command)</code></p>
<p>This opens a new window and provides help on the command. help(lm) for example, will give help on the linear modelling command that we have used extensively. The help is written in a terse and technical style however, which may be hard to understand at first but you get used to it. It is useful to see what options are available with each command - for many of the commands used in this guide more are available than have been described. Often, sufficient of the output from help makes sense to be able to get a command working by trial and error. At the bottom of the output, there are often examples of the command’s use: again not always easy to follow. In Rstudio, help is available (in the same unhelpful style) directly from the windows.</p>
<p><code>history(x)</code></p>
<p>In native R, this opens up a window with a list of the most recently issued x commands. The default number is 25. These can be copied back into the R window and re-executed. The window with the output can be saved from the File menu to keep a record of commands issued during the R session. In RStudio, the history of commands is available directly from a tab in the top right hand window.c</p>
<p><code>ls()  or equivalently objects()</code></p>
<p>Lists all the variables available in the current R session. This command can also be executed from the menu in native R, selecting first “Misc”, then “List objects”. In RStudio it is displayed using the Environment tab in the top right hand window.</p>
<p><code>matrix(data, nrow = x,ncol =y)</code></p>
<p>Defines a matrix and fills it with data. For example:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="more-useful-information.html#cb218-1"></a><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">12</span>),<span class="dt">nrow=</span><span class="dv">3</span>, <span class="dt">ncol=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]       [,4]
## [1,] -1.4547725 -0.8788952  1.3855051 -0.5439569
## [2,] -0.6538121  1.2675276 -0.7013855  1.4724045
## [3,] -0.4060148 -0.5898193  0.2879813  1.2272753</code></pre>
<p>The <code>rnorm()</code> part has simulated 12 random numbers which have a specified normal distribution.</p>
<p>Note that there is no need to define the column number ; it is fixed by the data and by the row number. More commonly, we would want to name the matrix. By default, all data are initially recorded as missing:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="more-useful-information.html#cb220-1"></a><span class="kw">matrix</span>(<span class="dt">nrow=</span><span class="dv">3</span>,<span class="dt">ncol=</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]   NA   NA   NA   NA
## [2,]   NA   NA   NA   NA
## [3,]   NA   NA   NA   NA</code></pre>
<p><code>rep(x,y)</code></p>
<p>Generates a repeated list:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="more-useful-information.html#cb222-1"></a><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##  [1] 1 2 3 1 2 3 1 2 3 1 2 3</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="more-useful-information.html#cb224-1"></a><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&#39;apples&#39;</span>,<span class="st">&#39;pears&#39;</span>),<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] &quot;apples&quot; &quot;pears&quot;  &quot;apples&quot; &quot;pears&quot;</code></pre>
<p>Remove an object:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="more-useful-information.html#cb226-1"></a><span class="kw">rm</span>(harvest_index)</span></code></pre></div>
<p>Remove those objects that are no longer required.</p>
<p><code>rm(list=ls(all.names=TRUE))</code> Would removes all variables, although this can be more easily achieved from the Session tab which offers more options.</p>
<p>Pull row names from a object (and only show first 5):</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="more-useful-information.html#cb227-1"></a><span class="kw">rownames</span>(TG_data_for_day_<span class="dv">1</span>)  [<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot;</code></pre>
<p>Pull column names:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="more-useful-information.html#cb229-1"></a><span class="kw">colnames</span>(TG_data_for_day_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;variety&quot;     &quot;year&quot;        &quot;ORIGIN&quot;      &quot;Rht2&quot;        &quot;PpdD1&quot;      
##  [6] &quot;yield&quot;       &quot;CALLOW_2011&quot; &quot;FRANCE_2010&quot; &quot;FRANCE_2011&quot; &quot;LGE_2010&quot;   
## [11] &quot;LGE_2011&quot;    &quot;NIAB_2011&quot;   &quot;FT&quot;          &quot;HT&quot;          &quot;AWNS&quot;</code></pre>
<p>You can also write new names:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="more-useful-information.html#cb231-1"></a><span class="kw">rownames</span>(TG_data_for_day_<span class="dv">1</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]&lt;-<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>)</span>
<span id="cb231-2"><a href="more-useful-information.html#cb231-2"></a><span class="kw">rownames</span>(TG_data_for_day_<span class="dv">1</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##  [1] &quot;a&quot;  &quot;b&quot;  &quot;c&quot;  &quot;4&quot;  &quot;5&quot;  &quot;6&quot;  &quot;7&quot;  &quot;8&quot;  &quot;9&quot;  &quot;10&quot;</code></pre>
<p><code>seq(x)</code></p>
<p>Generates a sequential list.</p>
<pre><code>`seq(10)`                 produces a list from 1:10. 
`seq(10,12,0.25)`       produces a list from 10 to 12 in steps of 1/4</code></pre>
<p><code>sink(filename)</code></p>
<p>Sends output to the given file rather than to the console. sink() with no filename will turn off the previous redirection, Useful if you are expecting lots of output. You can issue this before the command and then turn it off when the command has completed.</p>
<p><code>source(filename)</code></p>
<p>Runs commands from the filename - given as a variable containing the name or as the name itself in quotes.</p>
<p><code>split(x,y)</code></p>
<p>Partitions a variable or whole dataframe (x) into separate variables or dataframes on the basis of matches to y. Give this a go using:</p>
<p><code>split(yield,ORIGIN) [1:2]</code></p>
<p>In my hands, the following convoluted code will split our data into three separate data frames.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="more-useful-information.html#cb234-1"></a>DEU&lt;-<span class="kw">data.frame</span>(<span class="kw">split</span>(TG_data_for_day_<span class="dv">1</span>,ORIGIN)[<span class="dv">1</span>])</span>
<span id="cb234-2"><a href="more-useful-information.html#cb234-2"></a>FRA&lt;-<span class="kw">data.frame</span>(<span class="kw">split</span>(TG_data_for_day_<span class="dv">1</span>, ORIGIN)[<span class="dv">2</span>])</span>
<span id="cb234-3"><a href="more-useful-information.html#cb234-3"></a>UK&lt;-<span class="kw">data.frame</span>(<span class="kw">split</span>(TG_data_for_day_<span class="dv">1</span>, ORIGIN)[<span class="dv">3</span>])</span>
<span id="cb234-4"><a href="more-useful-information.html#cb234-4"></a><span class="kw">dim</span>(DEU)</span></code></pre></div>
<pre><code>## [1] 89 15</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="more-useful-information.html#cb236-1"></a><span class="kw">dim</span>(FRA)</span></code></pre></div>
<pre><code>## [1] 212  15</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="more-useful-information.html#cb238-1"></a><span class="kw">dim</span>(UK)</span></code></pre></div>
<pre><code>## [1] 73 15</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="more-useful-information.html#cb240-1"></a><span class="kw">dim</span>(TG_data_for_day_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 376  15</code></pre>
<p>The row numbers don’t add up because for some countries the origin was NA.</p>
<div id="learn-more" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Learn more</h3>
<p>Much useful information and documentation is available on the R web site:
<a href="http://www.r-project.org/" class="uri">http://www.r-project.org/</a>, including the R manual “An Introduction to R.”</p>
<p>Note, the manuals, including “An introduction to R”, are available directly from the Help menu from with R.</p>
<p>The book Introductory Statistics with R, Springer, 2002, ISBN 0-387-95475-9 is an excellent introduction both to R and to statistical analysis, with many simple examples.</p>
<p>R in a Nutshell, by Joseph Adler in the Nutshell series from O’Reilly gives a lot of detail about what and how R does what it does. An excellent reference book, but not for beginners.</p>
</div>
<div id="packages" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Packages</h3>
<p>Many are available from the Comprehensive R Archive network (CRAN) web site <a href="http://cran.r-project.org/" class="uri">http://cran.r-project.org/</a>. They can be installed directly from this site, or downloaded as zip files and installed later (useful if you need to install onto multiple machines). We shall be using several of these later.</p>
<p>These packages generally come with their own manual, often detailed. That for the R/QTL package, for example, runs to 96 pages. Although the CRAN website is the first place to search for suitable packages, they are also found elsewhere and are often referred to in methodological publications or the methods sections of paper: programming in R is an expanding industry. The more popular packages (R/QTL again) may have books published about them and often course material and lecture notes can be found on the web.</p>
<p>It is worth reiterating that our guide to the syntax and structures used in R has been very superficial. We have mentioned the data frame and little else. Knowledge of other structures - arrays, matrices, lists - should be acquired at some stage. They are explained in “An Introduction to R” but this book is not a page turner.</p>
</div>
<div id="r-commander-httpwww.rcommander.com" class="section level3">
<h3><span class="header-section-number">4.4.3</span> R commander <a href="http://www.rcommander.com/" class="uri">http://www.rcommander.com/</a></h3>
<p>For basic statistical analyses, and if you want to avoid typing or working on the command line, consider this package, which converts R into point-and-click statistical package just like all the others. You can download an introductory guide here:
<a href="http://cran.r-project.org/doc/contrib/Karp-Rcommander-intro.pdf" class="uri">http://cran.r-project.org/doc/contrib/Karp-Rcommander-intro.pdf</a></p>
</div>
<div id="the-tidyverse" class="section level3">
<h3><span class="header-section-number">4.4.4</span> The Tidyverse</h3>
<p>If you are new to R, it is worth putting the effort into learning about this. The website is:
<a href="https://www.tidyverse.org/" class="uri">https://www.tidyverse.org/</a>. The book “R for Data Science”, which is free online from this website is a very good introduction, including to ggplot.</p>
</div>
<div id="other-resources" class="section level3">
<h3><span class="header-section-number">4.4.5</span> Other resources</h3>
<p>For the “Understanding data types and R objects” section in this tutorial, inspiration was taken from www.datacarpentry.org/R-ecology-lesson. This is an excellent resource and worth checking out. Additionally, formal definitions were taken from the book “R in Action: Data Analysis and Graphics with R” by Robert Kabacoff.</p>
</div>
</div>
<div id="list-of-commands-mainly-described-in-this-guide." class="section level2">
<h2><span class="header-section-number">4.5</span> List of commands, mainly described in this guide.</h2>
<div id="general" class="section level4">
<h4><span class="header-section-number">4.5.0.1</span> General</h4>
<p><code>apply</code> = fast way of looping over rows and columns</p>
<p><code>attach</code> = attaches a dataset to R for subsequent analyses</p>
<p><code>attributes</code> = get information on the attributes of an object</p>
<p><code>cbind</code> = concatenate two tables or vectors by columns</p>
<p><code>colnames</code> = adds column names to a table or reads them from a table</p>
<p><code>detach</code> = attaches a dataset to R for subsequent analyses</p>
<p><code>demo</code> = demonstration a command (not available for most commands)</p>
<p><code>dim</code> = retrieve the dimensions of an object</p>
<p><code>factor</code> = convert a variable or text into a factor</p>
<p><code>for</code> = loop over a a set of commands with different input values</p>
<p><code>function</code> = define a function which can then be run repeatedly</p>
<p><code>getwd</code> = returns the path to the working directory</p>
<p><code>help</code> = returns help on a command</p>
<p><code>history</code> = lists previously issued commands</p>
<p><code>install.packages</code> = select a package to install</p>
<p><code>is.na</code> = returns TRUE if a value is NA.</p>
<p><code>length</code> = returns the number of entries in a variate</p>
<p><code>ls</code> = lists all active data structures and variates</p>
<p><code>matrix</code> = defines a matrix and fills it with data.</p>
<p><code>order</code> = returns the order or a variate for use in a subsequent sort</p>
<p><code>quit</code> = exit R</p>
<p><code>rbind</code> = concatenate two tables or vectors by rows</p>
<p><code>read.csv</code> = reads in data from .csv file</p>
<p><code>read.table</code> = reads in data</p>
<p><code>rep</code> = generates a list with repeating elements</p>
<p><code>rm</code> = delete data structures and variates from R</p>
<p><code>rownames</code> = adds row names to a table or reads them from a table</p>
<p><code>searchpaths</code> = lists attached packages and datasets in the order in which
searched.</p>
<p><code>seq</code> = creates a sequence of values</p>
<p><code>sink</code> = writes output to a file</p>
<p><code>sort</code> = sorts data</p>
<p><code>source</code> = reads commands from a file</p>
<p><code>split</code> = splits data on a factor value</p>
<p><code>subset</code> = selects a subset of data for subsequent analysis</p>
<p><code>table</code> = defines a table: used for input into contingency chi sq tests.</p>
</div>
<div id="graphical" class="section level4">
<h4><span class="header-section-number">4.5.0.2</span> Graphical</h4>
<p><code>abline</code> = add the best fitting straight line to a scattergram</p>
<p><code>boxplot</code> = produce a Box-and-whisker plot</p>
<p><code>heatmap</code> = plots a heatmap and dendogram</p>
<p><code>curve</code> = add a function to a graph</p>
<p><code>hist</code> = plot a histogram</p>
<p><code>image</code> = colours-in a matrix according to its values.</p>
<p><code>pairs</code> = plot multiple scattergrams in a matrix format</p>
<p><code>par</code> = set graphical parameters</p>
<p><code>pdf</code> = writes graphical output to a pdf file</p>
<p><code>plot</code> = produce a scattergram</p>
</div>
<div id="statistics" class="section level4">
<h4><span class="header-section-number">4.5.0.3</span> Statistics</h4>
<p><code>anova</code> = return an anova table from a linear model</p>
<p><code>apply</code> = applies a function to rows and/or columns of a matrix</p>
<p><code>chisq.test</code> = carry out a contingency chi-squared test</p>
<p><code>colMeans</code> = returns means across columns of a dataset</p>
<p><code>colSums</code> = returns totals across columns of a dataset</p>
<p><code>fisher.test</code> = carry out a Fisher’s exact test</p>
<p><code>cor</code> = returns the correlation coefficient</p>
<p><code>fitted</code> = returns the fitted values from a linear model</p>
<p><code>lm</code> = define and execute a linear model</p>
<p><code>mean</code> = returns the mean of a variate</p>
<p><code>median</code> = returns the median of a variate</p>
<p><code>minimum</code> = returns the minimum of a variate</p>
<p><code>maximum</code> = returns the maximum of a variate</p>
<p><code>pchisq</code> = returns the p-value of a chi-squared statistic</p>
<p><code>pnorm</code> = returns the p-value for a normally distributed variate</p>
<p><code>pt</code> = returns the p-value of a t-test</p>
<p><code>qchisq</code> = returns a chi-squared statistic for a given probability</p>
<p><code>pf</code> = returns the p-value of a F (variance ratio) statistic</p>
<p><code>qnorm</code> = returns a normality distributed variate for a given probability</p>
<p><code>quantile</code> = returns the quantiles of a variate</p>
<p><code>qf</code> = returns a F (variance ratio) statistic for a given probability</p>
<p><code>qt</code> = returns the t-test statistic for a given probability</p>
<p><code>sd</code> = returns the standard deviation of a variate</p>
<p><code>sum</code> = returns the sum of a variate</p>
<p><code>summary</code> = summarise data</p>
<p><code>resid</code> = returns the residuals from a linear model</p>
<p><code>rchisq</code> = returns random numbers from the chisq distribution</p>
<p><code>rf</code> = returns random numbers from the F distribution</p>
<p><code>rnorm</code> = returns random numbers from the normal distribution</p>
<p><code>rowMeans</code> = returns means across rows of a dataset</p>
<p><code>rowSums</code> = returns totals across rows of a dataset</p>
<p><code>runif</code> = returns random numbers from the uniform distribution</p>
<p><code>rt</code> = returns random numbers from the t distribution</p>
<p><code>t.test</code> = one and two sample t-test</p>
<p><code>var</code> = returns the mean of a variate</p>
<p><code>var.test</code> = compare two variances by an F test</p>

<div id="refs" class="references">
<div>
<p>Bentley, Alison R, Marco Scutari, Nicolas Gosman, Sebastien Faure, Felicity Bedford, Phil Howell, James Cockram, et al. 2014. “Applying association mapping and genomic selection to the dissection of key traits in elite European wheat.” <em>Theoretical and Applied Genetics</em> 127 (12): 2619–33. <a href="https://doi.org/10.1007/s00122-014-2403-y">https://doi.org/10.1007/s00122-014-2403-y</a>.</p>
</div>
<div>
<p>Xie, Yihui. 2015. <em>Dynamic Documents with R and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="http://yihui.name/knitr/">http://yihui.name/knitr/</a>.</p>
</div>
<div>
<p>———. 2020. <em>Bookdown: Authoring Books and Technical Documents with R Markdown</em>. <a href="https://CRAN.R-project.org/package=bookdown">https://CRAN.R-project.org/package=bookdown</a>.</p>
</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="R-and-stats.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-R_and_stats.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
